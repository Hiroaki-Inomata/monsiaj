<?xml version="1.0" encoding="us-ascii"?>
<!-- $Id: build.xml,v 1.9 2004-01-20 09:01:00 ozawa Exp $ -->
<project name="panda-client" default="compile" basedir=".">

  <!-- properties -->

  <property name="compile.debug"       value="yes"/>
  <property name="compile.deprecation" value="yes"/>
  <property name="compile.verbose"     value="no"/>
  <property name="clean.verbose"       value="no"/>

  <property name="src.dir"             value="src"/>
  <property name="build.dir"           value="bin"/>
  <property name="dist.dir"            value="dist"/>
  <property name="resources.dir"       value="resources"/>

  <path id="project.class.path">
    <pathelement path="/usr/share/java/xerces.jar"/>
    <pathelement path="/usr/share/java/log4j.jar"/>
  </path>

  <!-- targets -->

  <target name="prepare"
          description="Sets the timestamp and creates directories">
    <tstamp/>
    <mkdir dir="${build.dir}"/>
    <mkdir dir="${dist.dir}"/>
    <condition property="exclude.j2selogger" value="**/J2SELogger.java">
      <not>
        <available classname="java.util.logging.Logger"/>
      </not>
    </condition>
    <condition property="exclude.log4jlogger" value="**/Log4JLogger.java">
      <not>
        <available classname="org.apache.log4j.Logger"/>
      </not>
    </condition>
    <condition property="exclude.ssl" value="**/SSLSocketCreator.java">
      <not>
        <available classname="javax.net.ssl.SSLSocket"/>
      </not>
    </condition>
    <condition property="exclude.prefs" value="**/PreferenceBasedConfiguration.java">
      <not>
        <available classname="java.util.prefs.Preferences"/>
      </not>
    </condition>
  </target> 

  <target name="compile" depends="prepare"
    description="Compiles all Java sources.">
    <javac srcdir="${src.dir}"
           destdir="${build.dir}"
           verbose="${compile.verbose}"
	   deprecation="${compile.deprecation}" 
           debug="${compile.debug}">
      <include name="**/*.java"/>
      <exclude name="${exclude.j2selogger}"/>
      <exclude name="${exclude.log4jlogger}"/>
      <exclude name="${exclude.ssl}"/>
      <exclude name="${exclude.prefs}"/>
      <classpath refid="project.class.path"/>
    </javac>
  </target>

  <target name="resources" depends="prepare">
    <copy todir="${build.dir}">
      <fileset dir="${src.dir}" includes="**/*.properties"/>
      <fileset dir="${resources.dir}" includes="*.jpg"/>
    </copy>
  </target>
  <target name="jars" depends="compile,resources"
          description="Deploy jars">
    <!-- ant 1.5.x should use destfile instead of jarfile-->
    <jar jarfile="${dist.dir}/pandaclient.jar"
         basedir="${build.dir}"
         includes="org/montsuqi/**/*.class,org/montsuqi/**/*.properties"
         manifest="${resources.dir}/manifest.mf"/>
    <jar jarfile="${dist.dir}/jmareceipt.jar"
         basedir="${build.dir}"
         includes="jp/or/med/jma_receipt/**/*.class,jp/or/med/jma_receipt/**/*.properties"
         manifest="${resources.dir}/jmareceipt.mf"/>
  </target>

  <target name="buildclean"
          description="Cleans all built files.">
    <delete verbose="${clean.verbose}">
      <fileset dir="${build.dir}"/>
    </delete>
  </target>

  <target name="clean"
          description="Cleans temporary files and outputs.">
    <delete verbose="${clean.verbose}">
      <fileset dir="." defaultexcludes="no" includes="**/*~,**/.#*#"/>
    </delete>
  </target>

  <target name="veryclean" depends="clean,buildclean"
    description="Cleans all generated files.">
    <delete dir="${build.dir}" verbose="${clean.verbose}"/>
    <delete dir="${dist.dir}"  verbose="${clean.verbose}"/>
  </target>

</project>
